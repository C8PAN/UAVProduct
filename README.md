# UAVProduct处理说明
处理无人机影像的代码，使用了OpenMVG，openMVS以及GDAL库等，实现影像几何校正，影像拼接，点云生成等功能  
##1 处理流程  
* 构建全局影像参数
* 影像列表的构建以及各个文件夹的生成
* 影像特征点的解算
* 影像特征点的匹配
* 影像光束法平差
* 影像拼接得到DOM和点云数据

处理流程图：
![无人机影像处理流程](https://lh3.googleusercontent.com/-5X7qRpvaKXw/WYsi216jygI/AAAAAAAACTc/qQSY-BTdO8AwNEAl532NOIlUFHFM7hTkACLcBGAs/s0/%25E6%2597%25A0%25E4%25BA%25BA%25E6%259C%25BA%25E5%25A4%2584%25E7%2590%2586%25E6%25B5%2581%25E7%25A8%258B.png "无人机处理流程.png")  

## 2处理流程详细说明  

### 2.1 影像列表的构建  
这一步主要是进行一些估计和一些预处理的操作，实际上包括构建影像列表，解析POS数据得到处理影像大小得到影像的内参数据等，
在这一步中要获取影像的基本信息，并构建列表方便解算，另外在存在POS的情况下可以通过焦距和航高以及POS数据估算影像实际
的地面范围，然后将地面范围以KML数据的形式输出方便查看，同时估算拼接后影像数据大小

### 2.2 影像特征点的解算  
影像特征点的解算主要是通过SIFT特征进行解算，SIFT特征具有旋转不变，尺度不变光照不变等特点，由于其具有以上特征使得SIFT算子在特征点提取方面存在巨大的优势，SIFT特征点提取流程为：
* 1.尺度空间的建立
* 2.检测DoG空间极值点
* 3.空间极值点的精化处理
* 4.特征点方向计算
* 5.特征点方向特征描述子生成

下面详细介绍一下各个处理流程，首先是尺度空间的建立过程，对于输入影像建立影像金字塔，这个过程分为两个部分第一部分为影像尺度空间的降采样，每次对影像进行/2的降采样，得到的影像长和宽均为原影像的一般，第二部分为同一尺度空间的高斯模糊，通过不同尺度的高斯低通滤波算子对影像进行滤波，得到不同程度模糊的影像；第二个步骤为DoG空间极值点的计算，DoG空间极值即为高斯差分的空间极值，比较本空间和相邻两个尺度空间的DoG极值，取最大值，实际上DoG空间极值就是像素灰度变化最大的值，对影像来说角点，边缘点都可能具有较大的DoG值，实际上我们最需要的是角点信息，DoG局部曲率非常不对称的点，因此需要对步骤2检测到的空间极值点进行精化处理，精化处理的方法为：通过拟和三维二次函数以精确确定关键点的位置和尺度（达到亚像素精度），同时去除低对比度的关键点和不稳定的边缘响应点(因为DoG算子会产生较强的边缘响应)，以增强匹配稳定性、提高抗噪声能力。具体介绍参看：
进行精化后就可以得到影像特征点，在此情况下需要确定特征点的主方向，特征点的主方向通过梯度的模值和角度来确定主方向，获取主方向之后选取8*8窗口大小的窗口分成4*4的大小，则每一个窗口内有2*2个像素，计算像素的梯度则每一个2*2像素有八个方向的梯度，最后得到128维的特征描述子，最后对特征描述子进行归一化即可得到特征描述：
[SIFT参考](http://blog.csdn.net/abcjennifer/article/details/7639681/)

### 2.3 影像特征点匹配  

### 2.4 光束法平差的SFM过程  

### 2.5 影像拼接  

### 2.6 密集点云的生成  

## 3 安装与编译  
参见：http://wuweiblog.com/2017/08/24/%E7%A8%8B%E5%BA%8F%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/
